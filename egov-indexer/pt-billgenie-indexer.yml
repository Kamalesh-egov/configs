ServiceMaps:
  serviceName: Property Tax Bill-genie
  version: 1.0.0
  mappings:
    - topic: pt-bill-genie
      configKey: INDEX
      indexes:
        - name: save-bill-genie
          type: general
          id: $.bill.id ,$.bill.tenantId
          jsonPath: $
          timeStampField: $.auditDetails.lastModifiedBy
          isBulk: false
          customJsonMapping:
            indexMapping: {"Data":{"bill":{"id":"","mobilenumber":"","payername":"","payeraddress":"","payeremail":"","status":"","totalAmount":"","businessService":"","consumerCode":"","billDetails":{"billid":"","demandid":"","amount":""},"tenantId":"","taxheadcode":"","TaxPeriod":{"fromperiod":"","toperiod":"","financialyear":""},"@timestamp":"timestamp"},"propertyaddress":{"locality":{"doorNo":""}},"history":{},"auditDetails":{}}}
            fieldMapping:
              - inJsonPath: $.bill.id
                outJsonPath: $.Data.bill.id
              - inJsonPath: $.bill.mobilenumber
                outJsonPath: $.Data.bill.mobilenumber
              - inJsonPath: $.bill.payername
                outJsonPath: $.Data.bill.payername
              - inJsonPath: $.bill.payeraddress
                outJsonPath: $.Data.bill.payeraddress
              - inJsonPath: $.bill.payeremail
                outJsonPath: $.Data.bill.payeremail
              - inJsonPath: $.bill.status
                outJsonPath: $.Data.bill.status
              - inJsonPath: $.bill.totalAmount
                outJsonPath: $.Data.bill.totalamount
              - inJsonPath: $.bill.businessService
                outJsonPath: $.Data.bill.businessservice
              - inJsonPath: $.bill.consumerCode
                outJsonPath: $.Data.bill.consumercode
              - inJsonPath: $.bill.billDetails.billid
                outJsonPath: $.Data.bill.billDetails.billid
              - inJsonPath: $.bill.billDetails.demandid
                outJsonPath: $.Data.bill.billDetails.demandid
              - inJsonPath: $.bill.billDetails.amount
                outJsonPath: $.Data.bill.billDetails.amount
              - inJsonPath: $.bill.tenantId
                outJsonPath: $.Data.bill.tenantId
              - inJsonPath: $.bill.taxheadcode
                outJsonPath: $.Data.bill.taxheadcode
              - inJsonPath: $.bill.TaxPeriod.fromperiod
                outJsonPath: $.Data.bill.TaxPeriod.fromperiod
              - inJsonPath: $.bill.TaxPeriod.toperiod
                outJsonPath: $.Data.bill.TaxPeriod.toperiod
              - inJsonPath: $.bill.TaxPeriod.financialyear
                outJsonPath: $.Data.bill.financialyear
              - inJsonPath: $.bill.@timestamp
                outJsonPath: $.Data.@timestamp
              - inJsonPath: $.propertyaddress.locality.doorNo
                outJsonPath: $.Data.propertyaddress.locality.doorNo
            mdmsMapping:
              - path: https://dev.digit.org/egov-mdms-service/v1/_search
                moduleName: tenant
                masterName: tenants
                tenantId: pb
                filter: "[?(@.code == $tenant)]"
                filterMapping:
                  - variable: $tenant
                    valueJsonpath: $.bill.tenantId
                uriResponseMapping:
                  - inJsonPath: $.MdmsRes.tenant.tenants
                    outJsonPath: $.Data.tenantData