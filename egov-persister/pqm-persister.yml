serviceMaps:
  serviceName: pqm
  mappings:
    - version: 1.0
      description: Persists PQM Test Data in eg_pqm_tests table
      fromTopic: save-pqm-application
      isTransaction: true
      queryMaps:
        - query: INSERT INTO eg_pqm_tests(id, tenantId, plantCode, processCode, stageCode, materialCode, deviceCode, testType, status, wfStatus, scheduledDate, qualityCriteria, additionalDetails, isActive, createdBy, lastModifiedBy, createdTime, lastModifiedTime) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?::bigint, ?, ?, ?, ?, ?, ?, ?);
          basePath: $.tests.*
          jsonMaps:
            - jsonPath: $.tests.*.id
            - jsonPath: $.tests.*.tenantId
            - jsonPath: $.tests.*.plantCode
            - jsonPath: $.tests.*.processCode
            - jsonPath: $.tests.*.stageCode
            - jsonPath: $.tests.*.materialCode
            - jsonPath: $.tests.*.deviceCode
            - jsonPath: $.tests.*.testType
            - jsonPath: $.tests.*.status
            - jsonPath: $.tests.*.wfStatus
            - jsonPath: $.tests.*.scheduledDate
            - jsonPath: $.tests.*.qualityCriteria
              type: JSON
              dbType: JSONB
            - jsonPath: $.tests.*.additionalDetails
              type: JSON
              dbType: JSONB
            - jsonPath: $.tests.*.isActive
            - jsonPath: $.tests.*.auditDetails.createdBy
            - jsonPath: $.tests.*.auditDetails.lastModifiedBy
            - jsonPath: $.tests.*.auditDetails.createdTime
            - jsonPath: $.tests.*.auditDetails.lastModifiedTime


        - query: INSERT INTO eg_pqm_test_result_documents (id, testId, documentUid, documentUri, documentType, filestoreId, isActive, additionalDetails, createdBy, lastModifiedBy, createdTime, lastModifiedTime) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
          basePath: $.tests.*.documents.*
          jsonMaps:
            - jsonPath: $.tests.*.documents.*.id
            - jsonPath: $.tests.*.documents.*.testId
            - jsonPath: $.tests.*.documents.*.documentUid
            - jsonPath: $.tests.*.documents.*.documentUri
            - jsonPath: $.tests.*.documents.*.documentType
            - jsonPath: $.tests.*.documents.*.filestoreId
            - jsonPath: $.tests.*.documents.*.isActive
            - jsonPath: $.tests.*.documents.*.additionalDetails
              type: JSON
              dbType: JSONB
            - jsonPath: $.tests.*.documents.*.auditDetails.createdBy
            - jsonPath: $.tests.*.documents.*.auditDetails.lastModifiedBy
            - jsonPath: $.tests.*.documents.*.auditDetails.createdTime
            - jsonPath: $.tests.*.documents.*.auditDetails.lastModifiedTime

        - query: INSERT INTO eg_pqm_tests_auditlog (id, tenantId, plantCode, processCode, stageCode, materialCode, deviceCode, testType, status, wfStatus, scheduledDate, qualityCriteria, additionalDetails, isActive, createdBy, lastModifiedBy, createdTime, lastModifiedTime) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?::bigint, ?, ?, ?, ?, ?, ?, ?);
          basePath: $.tests.*
          jsonMaps:
            - jsonPath: $.tests.*.id
            - jsonPath: $.tests.*.tenantId
            - jsonPath: $.tests.*.plantCode
            - jsonPath: $.tests.*.processCode
            - jsonPath: $.tests.*.stageCode
            - jsonPath: $.tests.*.materialCode
            - jsonPath: $.tests.*.deviceCode
            - jsonPath: $.tests.*.testType
            - jsonPath: $.tests.*.status
            - jsonPath: $.tests.*.wfStatus
            - jsonPath: $.tests.*.scheduledDate
            - jsonPath: $.tests.*.qualityCriteria
              type: JSON
              dbType: JSONB
            - jsonPath: $.tests.*.additionalDetails
              type: JSON
              dbType: JSONB
            - jsonPath: $.tests.*.isActive
            - jsonPath: $.tests.*.auditDetails.createdBy
            - jsonPath: $.tests.*.auditDetails.lastModifiedBy
            - jsonPath: $.tests.*.auditDetails.createdTime
            - jsonPath: $.tests.*.auditDetails.lastModifiedTime

        - query: INSERT INTO eg_pqm_test_result_documents_auditlog (id, testId, documentUid, documentUri, documentType, filestoreId, additionalDetails, isActive, createdBy, lastModifiedBy, createdTime, lastModifiedTime) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
          basePath: $.tests.*.documents.*
          jsonMaps:
            - jsonPath: $.tests.*.documents.*.id
            - jsonPath: $.tests.*.documents.*.testId
            - jsonPath: $.tests.*.documents.*.documentUid
            - jsonPath: $.tests.*.documents.*.documentUri
            - jsonPath: $.tests.*.documents.*.documentType
            - jsonPath: $.tests.*.documents.*.filestoreId
            - jsonPath: $.tests.*.documents.*.additionalDetails
              type: JSON
              dbType: JSONB
            - jsonPath: $.tests.*.documents.*.isActive
            - jsonPath: $.tests.*.documents.*.auditDetails.createdBy
            - jsonPath: $.tests.*.documents.*.auditDetails.lastModifiedBy
            - jsonPath: $.tests.*.documents.*.auditDetails.createdTime
            - jsonPath: $.tests.*.documents.*.auditDetails.lastModifiedTime

